digraph {
    label="
        send 10 hTon to user2\l\
        first consolidate\l\
        then send tokens\l\
        "
    splines=spline

    /* Entities */
    external [ shape=point ]
    user1 [ shape=oval color=blue fontcolor=blue ]
    user2 [ shape=oval color=blue fontcolor=blue ]
    root [ shape=box color=purple style=filled ]
    wallet1 [ shape=box color=darkgreen style=filled ]
    wallet2 [ shape=box color=darkgreen style=filled ]

    /* Relationships */
    user1 -> wallet1 [ arrowhead=inv style=dotted ]
    user2 -> wallet2 [ arrowhead=inv style=dotted ]
    user1 -> root [ style=invis] // Just to put root on a lower line
    external -> user1
    user1 -> wallet1 [ label="1.1 TON" ]
    wallet1 -> root [ label="1.09 TON\lall tokens\l" ]
    root -> wallet1 [ label="1.08 TON\lconsolidated and reward distributed\l" ]
    wallet1 -> wallet2 [ label="1.07\l10 tokens\l" ]
    wallet2 -> user2 [ label="1 TON" ]
    wallet2 -> user1 [ label="excess: 0.06 TON" ]

    /* Ranks */
    { rank=min external user1 user2 }
    { rank=max wallet1 wallet2 }
}
